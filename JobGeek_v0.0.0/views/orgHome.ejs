<!DOCTYPE html >
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <% if(org.avatar.data){ %>
        <link rel="icon" type="image/-x-icon" style="border-radius: 2rem;"  href="data:image/<%=org.avatar.contentType%>;base64,<%=org.avatar.data.toString('base64')%>" />
        <% }else{ %>
            <link rel="icon" type="image/-x-icon" href='../public/images/default-user.svg'>
            <% } %>
        <title><%= org.org_name%>'s home</title>

        <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet" />
        <script src="https://cdn.tailwindcss.com"></script>
    </head>
    <body class="bg-gradient-to-r from-[#dd52a1] to-[#47b3f0] sm:from-pink-500 sm:to-sky-400 md:from-pink-500 md:to-sky-400 min-h-[100vh]">
        <style>
            footer {
                top: 100%;
                position: sticky;
                width: 100%;
                /* background-color: rgb(74, 45, 6); */
            }
            .sticky {
                position: fixed;
                top: 0;
                width: 100%;
            }

            
        </style>
        <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
        <!-- <nav id="jbNav" class="bg-black text-gray-100 sticky top-0 z-[1]">
            <ul class="flex justify-center mx-[10%]">
                <li class="p-2 xs:p-2 sm:p-2 md:p-4 lg:p-4 xl:p-6 hover:ab">
                    <a href="./home.html"><img src="../public/favicon/fav2/favicon-32x32.png" /></a>
                </li>
                <li class="p-2 xs:p-2 sm:p-2 md:p-4 lg:p-4 xl:p-6 hover:border-b-2 hover:pb-2 text-xs sm:text-base md:text-lg">
                    <a href="./home.html">Home</a>
                </li>
                <li class="p-2 xs:p-2 sm:p-2 md:p-4 lg:p-4 xl:p-6 hover:border-b-2 hover:pb-2 text-xs sm:text-base md:text-lg">
                    <a href="./about.html">About</a>
                </li>
                <li class="p-2 xs:p-2 sm:p-2 md:p-4 lg:p-4 xl:p-6 hover:border-b-2 hover:pb-2 text-xs sm:text-base md:text-lg">
                    <a href="./sample.html">Search employee</a>
                </li>
                <li class="p-2 xs:p-2 sm:p-2 md:p-4 lg:p-4 xl:p-6 hover:border-b-2 hover:pb-2 text-xs sm:text-base md:text-lg">
                    <a href="./sample.html">Search job</a>
                </li>
               
            </ul>
        </nav> -->
 
        <!-- org-nav => template render using js -->
         
        <navbar >
                 <ul class="inline px-[12rem] sticky top-0 z-[1] bg-black text-white">
                    <div class=" inline-flex items-ceneter">
            <% if(org.avatar.data){ %>
            <img class="inline rounded-full h-14 w-14 bg-cover"src="data:image/<%=org.avatar.contentType%>;base64,<%=org.avatar.data.toString('base64')%>">
            <% }else{ %>
                <img class="inline rounded-full h-12 w-12 bg-cover" src='https://www.nicepng.com/png/detail/128-1280406_view-user-icon-png-org-circle-icon-png.png'/>
            <% } %></div>

               <ul class="float-right">
                <li onclick="Account()" id="prev" titles="Manage credential,signout,change avatar,email,password" class="p-4  hover:border-b-2 hover:pb-4 text-xs sm:text-base md:text-lg float-left"> Account </li> 
                <li onclick="DashBoard()" id="prev" titles="Your profile visible on search-employee" class="p-4   hover:border-b-2 hover:pb-4 text-xs sm:text-base md:text-lg float-left"> DashBoard </li> 
                <li onclick="postJob()" id="prev" titles="Additional Personal details" class=" p-4  hover:border-b-2 hover:pb-4 text-xs sm:text-base md:text-lg float-left"> Post Job </li>
               </ul> 
            </ul>
        </navbar>
         
        <section
            class="max-h-[60rem] flex justify-start px-[1rem] sm:px-[5rem] md:px-[2.5rem] lg:px-[5rem] xl:px-[5rem] pt-[1rem] sm:pt-[2.5rem] md:pt-[2.5rem] lg:pt-[2.5rem] xl:pt-[5rem] pb-[2rem] sm:pb-[5rem] md:pb-[5rem] lg:pb-[5rem] xl:pb-[10rem]"
        >
            
           
            <div class="p-[2.5rem] min-h-[30rem] w-full" id="main_container">
                <div id="template" data-aos="fade-left" data-aos-offset="300" data-aos-easing="ease-in-out" class="bg-white h-full border-slate-400 border-4 border-solid p-14 max-h-[50rem] overflow-y-auto">
                    <p class="text-3xl">Click on navbar options to view in this block!!</p>
                </div>
            </div>
            
        </section>
 
        <!-- Navbar script -->
        <!-- 
            Navbar functions
            1)Account
            2)DashBoard
            3)Edit Profile
        -->
        <script>




            const org_name='<%= org.org_name %>';
            const Email='<%= org.email %>';
            let Avatar;
            '<% if(org.avatar.data){ %>'
             Avatar="data:image/<%=org.avatar.contentType%>;base64,<%=org.avatar.data.toString(`base64`)%>";
            '<%}else{%>'
             Avatar="../public/images/default-user.svg";
             '<% } %>'
            // tempData.innerHTML="<img id='avatar' class='rounded-full h-12 w-12 bg-cover' onerror='this.src=`https://www.nicepng.com/png/detail/128-1280406_view-org-icon-png-org-circle-icon-png.png`'/>"
           
            const token = '<%= org.token %>'

           
             
            const address ='<%= org.details.address %>'
           
            

     
            const contactNo='<%= org.details.contactNo %>'
            
            const latitude='<%= org.details.location.coordinates[0] %>'
            const longitude='<%= org.details.location.coordinates[1] %>'   
            
            
             
            function fade_out(name) {
                setTimeout(function(){document.getElementById(name).style.display="none"}, 1000);
            }
            function contactNoValidate() {
                    var pattern = new RegExp(/^\d{10}$/);

                    if (pattern.test(document.getElementById('ContactNo').value)) {
                        document.getElementById("error").innerHTML="valid contactno";
                        document.getElementById("error").style="color:green";
                        fade_out("error");
                         
                        return true;
                    }
                    else {
                        document.getElementById("error").innerHTML="not valid contactno";
                   
                        document.getElementById("error").style="color:red"
                        return false;
                    }
                }
            function avatarChange(){
                 // Get the file input and the form
                const fileInput = document.getElementById("update_image");
                const form = document.getElementById('my_form');
                console.log(fileInput,form)
                // Add an event listener to the file input
                fileInput.addEventListener('change', function() {
                // If a file has been selected
                    if (fileInput.files.length > 0) {
                        // Submit the form
                        form.submit();
                    }
                })
                ;}
             
            
            function Account() {
                    const tempData = document.getElementById("template");
           
                    tempData.innerHTML = `
<section>
    <legend >Account details:
        <form action="/org/login" method="get" class="inline">
            <button type="submit"  class=" bg-[url('/../public/images/log-out.svg')] bg-cover w-6 h-6 float-right"> </button>
        </form>
    </legend><br>
    <div class="bg-slate-100 m-4">
        <form action="/org/reset_avatar?token=`+token+`" method="post" id='my_form' enctype="multipart/form-data">
        <div class="justify-start flex items-center p-2">
            <label class="m-2">Avatar : </label>
            <img class="rounded-full h-12 w-12 bg-cover" id="avatar" onerror="this.src='../public/images/default-org.svg'" />
            <label  class="w-5 h-5 m-2 bg-[url('/../public/images/edit-icon.svg')] bg-cover"  ><input onclick="avatarChange()" id="update_image" type="file" name="avatar" class="hidden"><pre></pre> </label>
        </div>
        </form>
        <form action="/org/reset_email?token=`+token+`" method="post" >
            <div class="justify-start flex items-center p-2">
                <label class="m-2">Email:</label>
                <input id="email" type="text" class="  px-2" name="email" value="<%= org.email  %>" disabled />
                <button   class="w-5 h-5 m-2 bg-[url('/../public/images/edit-icon.svg')] bg-cover"><pre></pre></button>
            </div>
        </form>
        <div>
            <input type="text" name="id" defaultValue="<%= org._id %>" class="hidden"  >
        </div>
    </div>
        
   
</section>
 
            `;
           
                    document.getElementById("main_container").append(tempData);
                    document.getElementById("avatar").setAttribute("src",Avatar);
                }


            //DashBoard functions
            function AppliedCand(){
                    const tempData = document.getElementById("dashboardTemp");
                    
                    tempData.innerHTML = `<div class="p-2 max-h-[25rem] overflow-y-auto">
                         
                            
                        <% applications.forEach((row) => {
                        row.forEach((item) => { %>
                            <div class="rounded-lg bg-white shadow-md  m-2 shadow-inset ">
                                <div class="flex items-center bg-slate-100 py-2 px-8">
                                email: <%= item.email %>     
                                </div>
                            </div>
                        <% }); %>
                    <% }); %>
                    
                     </div>`;
                    document.getElementById("dashboardMain").append(tempData);
                     
                }
            function Status(){
                    const tempData = document.getElementById("dashboardTemp");
                    
                    tempData.innerHTML = ` 
                        <div class="p-2 max-h-[25rem] overflow-y-auto">

                            <div class="rounded-lg bg-white shadow-md shadow-inset flex items-center  justify-between h-2">
                                <p class="rounded-[2rem] h-6 w-6 bg-slate-400 text-white px-2">1</p>
                                <p class="rounded-[2rem] h-6 w-6 bg-slate-400 text-white px-2">2</p>
                                <p class="rounded-[2rem] h-6 w-6 bg-slate-400 text-white px-2 ">3</p>
                            </div>
                            <div class="py-4">
                            <span>Step 1:Post job</span><br>
                            <span>Step 2:Verify candidate</span><br>
                            <span>Step 3:Hire</span><br>
                                </div>
                        </div>
                     `;
                    document.getElementById("dashboardMain").append(tempData);
                }
            function Nearby(){
                    const tempData = document.getElementById("dashboardTemp");
                  
                    tempData.innerHTML = `
                    <% if(nearby[0]){ %>
                        <div class="p-2 max-h-[25rem] overflow-y-auto">
                            <h1 class="flex justify-center bg-slate-200">Candidates Within 15km to your location</h1>
                        <% nearby.forEach(function(el){ %>
                            <form action="/org/joboffer?token=`+token+`" method="post">
                            <div class="rounded-lg bg-white shadow-md  m-2 shadow-inset ">
                                <div class="flex items-center bg-slate-100 py-2 px-8">
                                    <img class="h-16 w-16 rounded-full border-[.1rem] border-solid" src="data:image/<%= el.imageUrl.contentType %>;base64,<%=el.imageUrl.data.toString('base64') %>">
                                    <label class=" mx-2">
                                    Title:<%= el.application_title %></label>
                                </div>
                                <div class="px-8 py-6">
                                <p class="max-h-[5rem] max-w-[35rem] overflow-y-auto break-all">
                                    Description:<%= el.desc %>
                                </p><br>
                                Salary:<%= el.salary %>
                                <input value="<%=  el.email %>" name="uemail" class="hidden">
                                <input value="`+Email+`" name="oemail" class="hidden">
                                <button type="submit"    class="rounded-lg bg-blue-400 px-2 py-[.2rem] float-right">Offer Job</button>
                                </div>
                            </div>
                        </form>
                        <% }) %>
                        </div>
                    <% }else{ %>
                        <label class="h-[10.5rem] w-full flex justify-center items-center">"Can't find nearby applications,according to your coordinates "</label><br>
                    <%}%>
                        `;
                    document.getElementById("dashboardMain").append(tempData);
                }
                
            function DashBoard() {
                const tempData = document.getElementById("template");

                tempData.innerHTML = `
                    <section class="w-full">
                        <div class="divided-x h-[4.5rem]  flex flex-row    bg-slate-200">
                            
                            <label onclick="AppliedCand()" border-[2rem] border-solid class="p-4  basis-[33.33%] h-[3.5rem] bg-slate-100 border-2 hover:border-b-4  " >Applied Candidcates</label>
                            <label onclick="Status()" class="p-4  basis-[33.33%] h-[3.5rem] bg-slate-100 border-2 hover:border-b-4 ">Status</label>
                            <label onclick="Nearby()" class="p-4  basis-[33.33%] h-[3.5rem] bg-slate-100 border-2 hover:border-b-4">Nearby</label>
                        </div><hr>
                        <div class="h-full w-full bg-slate-300 "  id="dashboardMain">
                                <div id="dashboardTemp"></div>
                            
                        </div>
                      
                    </section>`;
                    document.getElementById("main_container").append(tempData);
                }
            function postJob() {
                    const tempData = document.getElementById("template");
                    

                    tempData.innerHTML = ` 
    <form action="/org/create" class="px-[3rem] bg-white p-4" method="post" enctype="multipart/form-data">
        <div class=" text-gray-900 p-2">
            <h1><b class="text-lg">Post a Job</b></h1>
            <p>Please fill the form details ,this will visible to candidates</p>
        </div><hr class="my-4">
        
            <label for="title"> JOB-TITLE: <br>
             <input type="text" id="title" placeholder="title" name="job_title" class="w-full font-bold text-gray-500 bg-gray-200 my-2 flex  p-2">
            </label>
            <br>
        
            <label for="image">COVER IMAGE:<br>
                <input type="file" id="image"  name="image" class="w-full font-bold text-gray-500 bg-gray-200 my-2 flex  p-2">
            </label>
            <br>
        
            <label for="desc">DESCRIPTION:<br>
                <textarea id="desc" placeholder="JobRole details,required skills and experience" name="desc" class="w-full font-bold text-gray-500 bg-gray-200 my-2 flex  p-2">                    
                </textarea>
            </label>
            <br>
        
            <label for="salary">SALARY:<br>
                <input type="number" id="salary" placeholder="amount per month" name="salary" class="  font-bold text-gray-500 bg-gray-200 my-2 flex  p-2 w-1/3">
            </label>
            <br>
        
            <p class="font-bold text-gray-700">Add Job location</p>
            <br />
            <iframe id="map-iframe" width="600" height="450" frameborder="0" style="border: 0;" class="bg-gray-200" allowfullscreen></iframe> <br />
            <label>Add co-ordinates manually</label><br/>
            <pre>Latitude  :<input name='latitude' id='latitude' class='bg-slate-100' type='text' onkeyup='map()'  /></pre>          
            <pre>Longitude :<input name='longitude' id='longitude' class='bg-slate-100' type='text' onkeyup='map()'  /></pre>
            <label>Double click here To find your co-ordinates :</label> <label onclick="getLocation();map();" class="bg-blue-600 text-white rounded-md p-2">Locate</label>
            <p id="demo"></p>
            <br />
            <hr />
            <br />
            <input value="`+Email+`" class="hidden" type="text" name="joemail">
            <button class="p-2 bg-green-500 text-white" type="submit">Submit</button>
    </form>
 `
                    document.getElementById("main_container").append(tempData);
 
                }
        </script>
        <!-- location script -->
        <script>
            function map() {
                // Set the longitude and latitude variables
                let input1 = document.getElementById("latitude").value;
                let input2 = document.getElementById("longitude").value;

                // Parse the input values as numbers
                let latitude = parseFloat(input1).toFixed(10);
                let longitude = parseFloat(input2).toFixed(10);

                const iframeUrl = `https://www.openstreetmap.org/export/embed.html?marker=${latitude},${longitude}`;

                // Get a reference to the iframe element
                const iframe = document.querySelector("#map-iframe");

                // Set the src attribute of the iframe to the constructed URL
                iframe.src = iframeUrl;
            }

            var x = document.getElementById("demo");

            function getLocation() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(showPosition, showError);
                } else {
                    x.innerHTML = "Geolocation is not supported by this browser.";
                }
            }

            function showPosition(position) {
                document.getElementById("latitude").value = position.coords.latitude;
                document.getElementById("longitude").value = position.coords.longitude;
                // x.innerHTML = "Latitude: " + position.coords.latitude + "<br>Longitude: " + position.coords.longitude;
            }

            function showError(error) {
                switch (error.code) {
                    case error.PERMISSION_DENIED:
                        x.innerHTML = "org denied the request for Geolocation.";
                        break;
                    case error.POSITION_UNAVAILABLE:
                        x.innerHTML = "Location information is unavailable.";
                        break;
                    case error.TIMEOUT:
                        x.innerHTML = "The request to get org location timed out.";
                        break;
                    case error.UNKNOWN_ERROR:
                        x.innerHTML = "An unknown error occurred.";
                        break;
                }
            }
        </script>
        <footer>
            <section class="bg-gray-500 text-gray-100">
                <ul class="justify-center">
                    <li class="flex justify-center mx-4 py-5 font-bold">
                        Copy right 2022-<a href="./Home.html" class="hover:underline">Job Geek</a>
                        <p class="text-xs">TM</p>
                        .All right received
                    </li>
                    <li class="flex justify-center mx-4 py-5">Address-baroda,varnama,Babaria institute of technology</li>
                    <ul class="flex justify-center mx-4 py-5">
                        <li class="h-6 w-6 mx-2">
                            <a href="https://www.youtube.com/channel/UCpnW4eginLfg2rCcMjAn5dA?view_as=subscriber">
                                <img class="h-6" src="https://www.freepnglogos.com/uploads/youtube-logo-transparent-10.png" width="200" alt="youtube logo transparent" />
                            </a>
                        </li>
                        <li class="h-6 w-6 mx-2">
                            <a href="https://www.facebook.com/babaria.institute/">
                                <img class="h-6" src="https://www.freeiconspng.com/uploads/-van-de-laatste-nieuwsberichten-volg-ons-via-twitter-en-facebook-4.png" width="200" alt="Facebook new logo png" />
                            </a>
                        </li>
                        <li class="h-2 w-6 mx-2">
                            <a href="https://www.instagram.com/bits.edu.campus_official/?utm_source=ig_profile_share&igshid=15s3hwp5s8tp8">
                                <img src="https://img.icons8.com/fluency/48/000000/instagram-new.png" />
                            </a>
                        </li>
                    </ul>
                </ul>
            </section>
        </footer>
        <script>
            AOS.init({
                duration: 800,
            });
        </script>
    </body>
</html>
